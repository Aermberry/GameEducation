var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{u(o.next(e))}catch(t){i(t)}}function a(e){try{u(o["throw"](e))}catch(t){i(t)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,a)}u((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,i&&(s=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(o){n=[6,o],i=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},WordRepository=function(){function e(){}return e.prototype.getAll=function(){return["a","about","add","after","again","all","always","am","an","and","any","app","appoint","around","as","ate","away","bath","because","bee","before","better","big","black","blue","both","brain","brown","but","call","came","can","carry","clean","cold","come","could","cut","did","does","down","draw","drink","eat","eight","every","fair","fall (2)","fall","far","fast","film","film(2)","fine","first","five 2","five 3","five","fly","form","found","four","four(2)","from","gave","get","give","go","goal","god","going","goo","good","green","grow","guilt","gun","had","has","have","he","hear","heard","help","her","him","his","hold","hot","hour","how","i","in","into","is (2)","is","is(3)","it","jump","just","keep","kind","lab","left","light","like","little","live","long","look","made","make","male","many","may","me","mime","much","myself","never","new","no","no(2)","not","nut","of","off","old","on","one","only","open","or","our","out","over","pick","play","please","pretty","pull","put","ran","read","red","ride","right","round","run","sad","say","see","seven","shall","she","show","sick","sing","sit","sleep","small","so","some","start","stop","sunny","take","tell","ten","thank","that","the","them","then","there","these","they","thin","think","this","though","three","to","together","too","topday","try","two","under","up","us","use","very","walk","want (2)","want","war","warm","was","wash","we","well","went","were","what","when","where","which","white","who","why","will","wish","with","work","would","write","yellow","yet","your"]},e}();__reflect(WordRepository.prototype,"WordRepository");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function o(o){t.call(n,o,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?o(r):RES.getResAsync(e,o,this)}else RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return[4,this.loadResource()];case 1:return n.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=n.sent(),[4,platform.login()];case 3:return n.sent(),[4,platform.getUserInfo()];case 4:return t=n.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,this.loadTheme()];case 2:return n.sent(),[4,RES.loadGroup("preload",0,e)];case 3:return n.sent(),this.stage.removeChild(e),[3,5];case 4:return t=n.sent(),console.error(t),[3,5];case 5:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var o=new eui.Theme("resource/default.thm.json",e.stage);o.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){t.instance=this,this.addChild(new StartScene)},t.prototype.gotoScene=function(e){this.removeChildren(),this.addChild(e)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,o){function r(e){t.call(o,e)}function i(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),n.call(o))}var s=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(o,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(e,n){window.JSONParseClass.setData(e),r(e),egret.callLater(function(){t.call(o,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Cannon=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.setCurrentState=function(e){this.currentState=e,RES.getRes("sound_effect_kacha_mp3").play(0,1)},t}(eui.Component);__reflect(Cannon.prototype,"Cannon",["eui.UIComponent","egret.DisplayObject"]);var TargetButton=function(e){function t(){var t=e.call(this)||this;return t._cannonballExitX=0,t._cannonballExitY=0,t}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addEventListener(mouse.MouseEvent.ROLL_OVER,this.onMouseOver,this),this.addEventListener(mouse.MouseEvent.ROLL_OUT,this.onMouseOut,this)},t.prototype.onMouseOver=function(e){this.currentState="selected"},t.prototype.onMouseOut=function(e){this.enabled&&(this.currentState="up")},t.prototype.playShootedAnimation=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return console.log("htting"),this.currentState="hitting",[4,ThreadUtility.sleep(100)];case 1:return e.sent(),this.currentState="down",this.enabled=!1,[2]}})})},Object.defineProperty(t.prototype,"cannonballExitX",{get:function(){return this._cannonballExitX},set:function(e){this._cannonballExitX=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cannonballExitY",{get:function(){return this._cannonballExitY},set:function(e){this._cannonballExitY=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftOrRight",{get:function(){return this._leftOrRight},set:function(e){this._leftOrRight=e},enumerable:!0,configurable:!0}),t.prototype.setLabel=function(e){this.label=e,egret.Tween.get(this.sunshineImage).to({scaleX:1,scaleY:1},500).to({scaleX:0,scaleY:0})},t.prototype.reset=function(){this.currentState="up",this.enabled=!0},t}(eui.Button);__reflect(TargetButton.prototype,"TargetButton",["eui.UIComponent","egret.DisplayObject"]);var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var PlayingScene=function(e){function t(){var t=e.call(this)||this;return t.targets=[],t.timeLeftInRoundImageOriginalHeight=658,t.secondsInTotalGame=180,t.secondsLeftInTotal=0,t.secondsPerRound=20,t.secondsLeftInRound=0,t.secondsToHurry=6,t.hurryIsAlerting=!1,t.passedCurrentRound=!1,t.stoppedFire=!1,t.allWords=(new WordRepository).getAll(),t.spokenWord="a",t}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),mouse.enable(this.stage),this.initTargets(),this.initSpeakerButton(),this.initReadyTweenGroup(),this.initHurryTweenGroup(),this.initBackButton(),this.startGame()},t.prototype.speakCurrentWord=function(){RES.getRes(this.spokenWord+"_mp3").play(0,1)},t.prototype.initTargets=function(){for(var e=0;e<this.numChildren;e++){var t=this.getChildAt(e);t instanceof TargetButton&&this.targets.push(t)}for(var n=0,o=this.targets;n<o.length;n++){var r=o[n];r.addEventListener(mouse.MouseEvent.MOUSE_OVER,this.onTargetMouseOver,this),r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTargetClick,this)}},t.prototype.initSpeakerButton=function(){var e=this;this.speakerImage.addEventListener(mouse.MouseEvent.ROLL_OVER,function(){return e.speakerImage.source="speaker_selected_svg"},this),this.speakerImage.addEventListener(mouse.MouseEvent.ROLL_OUT,function(){return e.speakerImage.source="speaker_normal_svg"},this),this.speakerImage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return e.speakCurrentWord()},this)},t.prototype.initReadyTweenGroup=function(){this.readyTweenGroup.addEventListener(egret.Event.COMPLETE,this.onReadyTweenGroupComplete,this)},t.prototype.onReadyTweenGroupComplete=function(){this.secondsLeftInTotal=this.secondsInTotalGame,this.startNewRound(),this.tickInterval=egret.setInterval(this.intervalHandler,this,100)},t.prototype.initHurryTweenGroup=function(){this.hurryTweenGroup.addEventListener(egret.Event.COMPLETE,this.onHurryTweenGroupComplete,this)},t.prototype.onHurryTweenGroupComplete=function(){this.hurryIsAlerting&&this.playHurryAnimation()},t.prototype.initBackButton=function(){this.backImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackImageClick,this)},t.prototype.onBackImageClick=function(e){Main.instance.gotoScene(new StartScene)},t.prototype.startGame=function(){this.readyTweenGroup.play(0)},t.prototype.resetTargetWords=function(){for(var e=0,t=this.targets;e<t.length;e++){var n=t[e];n.reset(),n.setLabel(this.getRandomWord())}this.spokenWord=this.targets[this.random(0,this.targets.length-1)].label,this.speakCurrentWord()},t.prototype.getRandomWord=function(){var e=this.random(0,this.allWords.length-1);return this.allWords[e]},t.prototype.random=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},t.prototype.onTargetMouseOver=function(e){this.cannon.setCurrentState(e.target.leftOrRight)},t.prototype.onTargetClick=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return this.stoppedFire?[2]:(t=e.target,this.shootAt(t),this.spokenWord!=t.label?[3,2]:(this.stoppedFire=!0,this.playTipAnimation("Good job!"),[4,ThreadUtility.sleep(2e3)]));case 1:return n.sent(),this.passedCurrentRound=!0,[3,3];case 2:this.playTipAnimation("Try Again!"),n.label=3;case 3:return[2]}})})},t.prototype.shootAt=function(e){var t=this,n=e.x,o=e.y+e.height/2,r=this.createCannonball();this.addChild(r),egret.Tween.get(r).to({x:n,y:o},100).call(function(){return e.playShootedAnimation()},this).call(function(){return t.playBullseyeSound(e)},this).to({x:e.cannonballExitX,y:e.cannonballExitY},100).call(function(){return t.removeChild(r)},this)},t.prototype.playBullseyeSound=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.spokenWord==e.label?(RES.getRes("sound_effect_jiu_mp3").play(0,1),RES.getRes("sound_effect_ling_mp3").play(0,1)):RES.getRes("sound_effect_dindum_mp3").play(0,1),[2]})})},t.prototype.createCannonball=function(){var e=new eui.Image("cannonball_svg");return e.scaleY=e.scaleX=.7,e.x=this.width/2,e.y=this.height,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e},t.prototype.intervalHandler=function(){return this.timeLeftInRoundImage.height=this.timeLeftInRoundImageOriginalHeight*this.secondsLeftInRound/this.secondsPerRound,this.secondsLeftInRound-=.1,this.secondsLeftInTotal-=.1,this.secondsLeftInTotal<=0?(egret.clearInterval(this.tickInterval),void RES.getRes("sound_effect_win_mp3").play(0,1)):(this.showTimeLeftInTotal(),this.secondsLeftInRound<this.secondsToHurry&&!this.hurryIsAlerting&&(this.hurryIsAlerting=!0,this.playHurryAnimation()),this.secondsLeftInRound<=0&&(console.log("时间到，进入下一轮"),this.playTipAnimation("Next Question!"),this.startNewRound()),void(this.passedCurrentRound&&(console.log("用户答对进入下一轮"),this.passedCurrentRound=!1,this.startNewRound())))},t.prototype.startNewRound=function(){this.hurryIsAlerting=!1,this.resetTargetWords(),this.secondsLeftInRound=this.secondsPerRound,this.stoppedFire=!1},t.prototype.showTimeLeftInTotal=function(){this.minutesLabel.text=Math.floor(this.secondsLeftInTotal/60).toString(),this.secondsLabel.text=Math.floor(this.secondsLeftInTotal%60).toString()},t.prototype.playHurryAnimation=function(){this.hurryTweenGroup.play(0)},t.prototype.playTipAnimation=function(e){this.tipLabel.text=e,this.tipTweenGroup.play(0)},t}(eui.Component);__reflect(PlayingScene.prototype,"PlayingScene",["eui.UIComponent","egret.DisplayObject"]);var ReadyToPlayScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.bgmSoundChannel=RES.getRes("select_difficulty_scene_bgm_mp3").play(),this.backImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackImageClick,this),this.goImage.addEventListener(mouse.MouseEvent.ROLL_OVER,this.onGoImageMouseOver,this),this.goImage.addEventListener(mouse.MouseEvent.ROLL_OUT,this.onGoImageMouseOut,this),this.goImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGoImageClick,this),this.goLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGoImageClick,this),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("game_demo_json"),RES.getRes("game_demo_png")),this.planGameDemoAnimation()},t.prototype.onBackImageClick=function(e){this.bgmSoundChannel.stop(),Main.instance.gotoScene(new StartScene)},t.prototype.onGoImageMouseOver=function(e){e.target.source="stars_separated_svg"},t.prototype.onGoImageMouseOut=function(e){e.target.source="stars_joined_svg"},t.prototype.onGoImageClick=function(e){this.bgmSoundChannel.stop(),Main.instance.gotoScene(new PlayingScene)},t.prototype.planGameDemoAnimation=function(){var e=new egret.MovieClip(this.mcFactory.generateMovieClipData("game demo"));e.x=320,e.y=315,this.addChild(e),e.play(-1)},t}(eui.Component);__reflect(ReadyToPlayScene.prototype,"ReadyToPlayScene",["eui.UIComponent","egret.DisplayObject"]);var ResultScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t}(eui.Component);__reflect(ResultScene.prototype,"ResultScene",["eui.UIComponent","egret.DisplayObject"]);var SelectDifficultyScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.bgmSoundChannel=RES.getRes("select_difficulty_scene_bgm_mp3").play(),mouse.enable(this.stage),this.backImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackImageClick,this),this.easyImage.addEventListener(mouse.MouseEvent.ROLL_OVER,this.onSelectDifficultyMouseOver,this),this.easyImage.addEventListener(mouse.MouseEvent.ROLL_OUT,this.onSelectDifficultyMouseOut,this),this.easyImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEasyImageClick,this),this.easyLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEasyImageClick,this),this.proImage.addEventListener(mouse.MouseEvent.ROLL_OVER,this.onSelectDifficultyMouseOver,this),this.proImage.addEventListener(mouse.MouseEvent.ROLL_OUT,this.onSelectDifficultyMouseOut,this),this.proImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onProImageClick,this),this.proLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onProImageClick,this),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("movie_clip_json"),RES.getRes("movie_clip_png")),this.playSixWidgetsPopupAnimation()},t.prototype.onBackImageClick=function(e){this.bgmSoundChannel.stop(),Main.instance.gotoScene(new StartScene)},t.prototype.onSelectDifficultyMouseOver=function(e){e.target.source="stars_separated_svg"},t.prototype.onSelectDifficultyMouseOut=function(e){e.target.source="stars_joined_svg"},t.prototype.onEasyImageClick=function(e){this.bgmSoundChannel.stop(),Main.instance.gotoScene(new ReadyToPlayScene)},t.prototype.onProImageClick=function(e){this.bgmSoundChannel.stop(),Main.instance.gotoScene(new ReadyToPlayScene)},t.prototype.playSixWidgetsPopupAnimation=function(){var e=new egret.MovieClip(this.mcFactory.generateMovieClipData("six widgets popup"));e.x=0,e.y=890,e.scaleX=e.scaleY=4,this.addChild(e),e.play(1)},t}(eui.Component);__reflect(SelectDifficultyScene.prototype,"SelectDifficultyScene",["eui.UIComponent","egret.DisplayObject"]);var StartScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),mouse.enable(this.stage),this.sightWordHunterImage.addEventListener(mouse.MouseEvent.ROLL_OVER,this.onSightWordHunterMouseOver,this),this.sightWordHunterImage.addEventListener(mouse.MouseEvent.ROLL_OUT,this.onSightWordHunterMouseOut,this),this.sightWordHunterImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSightWordHunterClick,this),this.bgmSoundChannel=RES.getRes("start_scene_bgm_mp3").play(0,-1),this.mcFactory=new egret.MovieClipDataFactory(RES.getRes("movie_clip_json"),RES.getRes("movie_clip_png")),egret.Tween.get(this.rainbowImage).to({x:0},500).call(function(){return t.sightWordParkImage.visible=!0},this).wait(500).call(this.showChooseAGameToPlay,this)},t.prototype.showChooseAGameToPlay=function(){var e=new egret.MovieClip(this.mcFactory.generateMovieClipData("choose a game to play"));e.x=385,e.y=450,this.addChild(e),e.play(-1)},t.prototype.onSightWordHunterMouseOver=function(e){this.sightWordHunterImage.source="sight_word_hunter_mouse_over_png"},t.prototype.onSightWordHunterMouseOut=function(e){this.sightWordHunterImage.source="sight_word_hunter_normal_png"},t.prototype.onSightWordHunterClick=function(e){this.bgmSoundChannel.stop(),Main.instance.gotoScene(new SelectDifficultyScene)},t}(eui.Component);__reflect(StartScene.prototype,"StartScene",["eui.UIComponent","egret.DisplayObject"]);var ThreadUtility=function(){function e(){}return e.sleep=function(e){return void 0===e&&(e=0),new Promise(function(t){return setTimeout(t,e)})},e}();__reflect(ThreadUtility.prototype,"ThreadUtility");